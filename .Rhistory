seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(b.no) , basistype = "te", transform='standardized') + unlist(flw.no.b1)
,family='nb')
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1,, basistype = "te", transform='standardized') +unlist(flw.no.b1) + unlist(b.no),
family='nb')
AIC(fit, fit1, fit2, fit3)# te basistype
summary(fit1) # te
summary(fit) # te
fit<- coef(fit2)   #Note: are these transformed?
fit<- coef(fit3)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit<- coef(fit)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
summary(fit1) # te
fit<- coef(fit1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
fit
write.table(fit, file="C:/Users/mason/Dropbox/git/Vicia/Results and Figures/within_branch_B_BRANCH1.csv",
sep=",", quote = F)
dat<- read.csv("vicia_five_five.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==2)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
summary(fit1) # te
fit<- coef(fit1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(b.no) , basistype = "te", transform='standardized') + unlist(flw.no.b1)
,family='nb')
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1,, basistype = "te", transform='standardized') +unlist(flw.no.b1) + unlist(b.no),
family='nb')
AIC(fit, fit1, fit2, fit3)# te basistype
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
AIC(fit, fit1, fit2, fit3)# te basistype
fit<- coef(fit)   #Note: are these transformed?
summary(fit) # te
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
summary(fit) # te
summary(fit1) # te
summary(fit2) # te
summary(fit3) # te
dat<- read.csv("vicia_final_data.csv")
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==1)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
summary(fit1) # te
fit<- coef(fit1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
write.table(fit, file="C:/Users/mason/Dropbox/git/Vicia/Results and Figures/within_branch_B_BRANCH1.csv",
sep=",", quote = F)
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==2)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
summary(fit2) # te
summary(fit1) # te
fit<- coef(fit1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
write.table(fit, file="C:/Users/mason/Dropbox/git/Vicia/Results and Figures/within_branch_B_BRANCH2.csv",
sep=",", quote = F)
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==3)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=5, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
,family='nb')
summary(fit1) # te
fit<- coef(fit1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
write.table(fit, file="C:/Users/mason/Dropbox/git/Vicia/Results and Figures/within_branch_B_BRANCH3.csv",
sep=",", quote = F)
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==4)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=3, basistype = "te", transform='standardized')
,family='nb')
summary(fit1) # te
fit<- coef(fit1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
b1$branch.flw<- as.numeric(b1$Branch)
branch.flw<- aggregate(b1$branch.flw, by=list(b1$PlantID), max)
branch.flw$Group.1<- NULL
branch.flw<- as.data.frame(branch.flw)
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==1)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b1$branch.flw<- as.numeric(b1$Branch)
branch.flw<- aggregate(b1$branch.flw, by=list(b1$PlantID), max)
branch.flw$Group.1<- NULL
branch.flw<- as.data.frame(branch.flw)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw) , basistype = "te", transform='standardized') + unlist(flw.no.b1)
,family='nb')
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw),, basistype = "te", transform='standardized') +unlist(flw.no.b1) + unlist(b.no),
family='nb')
AIC(fit, fit1, fit2, fit3)# te basistype
summary(fit,fit1, fit2, fit3) # te
summary(fit) # te
summary(fit1) # te
summary(fit2) # te
summary(fit3) # te
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw) , basistype = "te", transform='standardized')
,family='nb')
summary(fit2) # te
fit<- coef(fit2)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw),, basistype = "te", transform='standardized') + unlist(b.no),
family='nb')
summary(fit3) # te
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
summary(fit1.1) # te
AIC(fit, fit1, fit.1.1,fit2, fit3)# te basistype
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw) , basistype = "te", transform='standardized')
,family='nb')
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw),, basistype = "te", transform='standardized') + unlist(b.no),
family='nb')
AIC(fit, fit1, fit.1.1,fit2, fit3)#
AIC(fit, fit1, fit1.1,fit2, fit3)# te basistype
fit<- coef(fit1.1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
fit
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==3)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b1$branch.flw<- as.numeric(b1$Branch)
branch.flw<- aggregate(b1$branch.flw, by=list(b1$PlantID), max)
branch.flw$Group.1<- NULL
branch.flw<- as.data.frame(branch.flw)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=5, basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
summary(fit1.1) # te
fit<- coef(fit1.1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==1)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b1$branch.flw<- as.numeric(b1$Branch)
branch.flw<- aggregate(b1$branch.flw, by=list(b1$PlantID), max)
branch.flw$Group.1<- NULL
branch.flw<- as.data.frame(branch.flw)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw) , basistype = "te", transform='standardized')
,family='nb')
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw),, basistype = "te", transform='standardized') + unlist(b.no),
family='nb')
AIC(fit, fit1, fit1.1,fit2, fit3)
summary(fit1.1) # te
fit<- coef(fit1.1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
dat<- read.csv("vicia_final_data.csv")
dat$PlantID<- as.factor(dat$PlantID)
dat$Branch<- as.factor(dat$Branch)
dat$Pos<- as.factor(dat$Pos)
dat$b_num<- as.numeric(dat$Branch)
# load data with only first 5 branches and first 5 flowers
#five<- read.csv("vicia_five_five.csv")
#########################3
#
# Compare patterns of selection within branches
# organize data
dat2<- dat[!is.na(dat$B), ]
dat<-dat2
b1<- subset(dat, Branch ==2)
# Branch 1
seed.b1<- aggregate(b1$seeds, by=list(b1$PlantID), sum)
seed.b1$Group.1<- NULL
flw.no.b1<- aggregate(b1$PosSeq, by=list(b1$PlantID), max)
flw.no.b1$Group.1<-NULL
flw.no.b1<- as.matrix(flw.no.b1)
flw.no.b1<- as.vector(flw.no.b1)
flw.no.b1<- as.data.frame(flw.no.b1)
b1$branch.flw<- as.numeric(b1$Branch)
branch.flw<- aggregate(b1$branch.flw, by=list(b1$PlantID), max)
branch.flw$Group.1<- NULL
branch.flw<- as.data.frame(branch.flw)
b<- aggregate(b1$b_num, by=list(b1$PlantID), max)
b$Group.1<- NULL
b.no<- as.data.frame(b)
B1<- b1[c("PlantID","Pos", "B")]
# Reshape into long-format matrix
long<- reshape(B1, timevar="Pos", idvar=c("PlantID"), direction = "wide")
long$PlantID<- NULL
long<- as.matrix(long)
B.1<-long
# Banner Branch 1 (all plants)
fit<- pfr(seed.b1 ~ lf.vd(B.1, vd=B.1, basistype = "te", transform='standardized')
,family='nb')
fit1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1), basistype = "te", transform='standardized')
,family='nb')
fit1.1<- pfr(seed.b1 ~ lf.vd(B.1,vd=unlist(flw.no.b1),k=4, basistype = "te", transform='standardized')
+ unlist(branch.flw),family='nb')
fit2<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw) , basistype = "te", transform='standardized')
,family='nb')
fit3<- pfr(seed.b1 ~ lf.vd(B.1, vd=unlist(branch.flw),, basistype = "te", transform='standardized') + unlist(b.no),
family='nb')
AIC(fit, fit1, fit1.1,fit2, fit3)
summary(fit1.1) # te
fit<- coef(fit1.1)   #Note: are these transformed?
#make absolute frstart date
fit$x<- fit$B.1.arg * fit$B.1.vd
plot(fit$x, fit$value, type="l", main="absolute")
