---
title: "Characterization of and selection on compound within-individual floral variation in *Vicia americana* (Fabaceae)"
author:
  - "Mason W. Kulbaba^[St. Mary's University, mason.kulbaba@stmu.ca, https://orcid.org/0000-0003-0619-7089]"
 
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  bookdown::pdf_document2:
    extra_dependencies: "amscd"
    number_sections: true
    toc: true
    toc_depth: 3
linkcolor: blue
urlcolor: blue
---

# Abstract {-}

This document provides code to reproduce all results from the manuscript `Characterization of and selection on compound within-individual floral variation in *Vicia americana* (Fabaceae)`. The data file `vicia_final_data.csv` contains all data required to reproduce all results in the manuscript, and is located in the associated Zenodo repository.

# R

 * The version of R used to make this document is `r getRversion()`.

 * The version of the `rmarkdown` package used to make this document is
   `r packageVersion("rmarkdown")`.

 * The version of the `bookdown` package used to make this document is
   `r packageVersion("bookdown")`.

 * The version of the `dplyr` package used to make this document is
   `r packageVersion("dplyr")`.

 * The version of the `glmmTMB` package used to make this document is
   `r packageVersion("glmmTMB")`.

 * The version of the `DHARMa` package used to make this document is
   `r packageVersion("DHARMa")`.

 * The version of the `car` package used to make this document is
   `r packageVersion("car")`.

 * The version of the `caret` package used to make this document is
   `r packageVersion("caret")`.

 * The version of the `Hmisc` package used to make this document is
   `r packageVersion("Hmisc")`.
   
 * The version of the `tidyr` package used to make this document is
   `r packageVersion("tidyr")`.
   
 * The version of the `viridis` package used to make this document is
   `r packageVersion("viridis")`.
   
 * The version of the `refund` package used to make this document is
   `r packageVersion("refund")`.

Attach packages.
```{r package}

suppressMessages(library("dplyr"))
suppressMessages(library("glmmTMB"))
suppressMessages(library("ggplot2"))
suppressMessages(library("DHARMa"))
suppressMessages(library("car"))
suppressMessages(library("caret"))
suppressMessages(library("Hmisc"))
suppressMessages(library("tidyr"))
suppressMessages(library("viridis"))
suppressMessages(library("refund"))

```

Need at least version 1.3-4 of R package `aster` for R generic function `vcov`
to work on results of calls to R functions `aster` and `reaster`.
```{r aster-version}
#Nope 
```

where the variables are

 * `Germ` is germination indicator (0 = no, 1 = yes), conditionally Bernoulli.

 * `flw` is survival to flowering (0 = no, 1 = yes),
    conditionally Bernoulli.

 * `total.pods` is total number of pods produced,
   conditionally Poisson.

 * `total.pods.collected` is number of pods collected,
   conditionally Bernoulli (i.e. each pod may be collected or not).
   The arrow leading to this node
   is a subsampling arrow.  The number of pods collected is
   a random sample of the pods produced.

 * `totalseeds` is total number of seeds counted from collected pods,
   conditionally Poisson.

As always with aster models, the name of the distribution for an arrow
is the name of the conditional distribution of the successor variable
given the predecessor variable.
The arrow labeled `samp` is a subsampling arrow.  It is a Bernoulli
arrow but the sampling is experimental rather than biological.
This arrow may be [missing in some analyses](#alternative-structure).

Set graphical model description in R.
```{r graph}
vars <- c("Germ", "flw", "total.pods", "total.pods.collected", "totalseeds")
pred <- c(0, 1, 2, 3, 4)
fam <- c(1, 1, 2, 1, 2)
```

## Alternative Structure
